diff --git a/node_modules/@greenwood/plugin-renderer-lit/src/execute-route-module.js b/node_modules/@greenwood/plugin-renderer-lit/src/execute-route-module.js
index 5e73f75..2deef38 100644
--- a/node_modules/@greenwood/plugin-renderer-lit/src/execute-route-module.js
+++ b/node_modules/@greenwood/plugin-renderer-lit/src/execute-route-module.js
@@ -1,30 +1,17 @@
-// this needs to come first
-import { render } from '@lit-labs/ssr/lib/render-with-global-dom-shim.js';
-import { Buffer } from 'buffer';
+import { render } from '@lit-labs/ssr';
+import { collectResult } from '@lit-labs/ssr/lib/render-result.js'
 import { html } from 'lit';
 import { unsafeHTML } from 'lit-html/directives/unsafe-html.js';
-import { Readable } from 'stream';
-
-async function streamToString (stream) {
-  const chunks = [];
-
-  for await (let chunk of stream) {
-    chunks.push(Buffer.from(chunk));
-  }
-
-  return Buffer.concat(chunks).toString('utf-8');
-}
-
-async function getTemplateResultString(template) {
-  return await streamToString(Readable.from(render(template)));
-}
 
 async function executeRouteModule({ moduleUrl, compilation, page, prerender, htmlContents, scripts }) {
+  // TODO await import('@lit-labs/ssr/lib/install-global-dom-shim.js');
   const data = {
     template: null,
     body: null,
     frontmatter: null,
-    html: null
+    html: null,
+    hydrate: false,
+    pageData: {},
   };
 
   // prerender static content
@@ -35,28 +22,30 @@ async function executeRouteModule({ moduleUrl, compilation, page, prerender, htm
 
     const templateResult = html`${unsafeHTML(htmlContents)}`;
 
-    data.html = await getTemplateResultString(templateResult);
+    data.html = await collectResult(render(templateResult));
   } else {
     const module = await import(moduleUrl).then(module => module);
-    const { getTemplate = null, getBody = null, getFrontmatter = null } = module;
+    const { getTemplate = null, getBody = null, getFrontmatter = null, hydration = false, loader } = module;
 
-    if (module.default && module.tagName) {
-      const { tagName } = module;
-      const templateResult = html`
-        ${unsafeHTML(`<${tagName}></${tagName}>`)}
-      `;
+    if (hydration) {
+      data.hydrate = true;
+    }
+
+    if (loader) {
+      data.pageData = await loader(); // request, compilation, etc can go here
+      console.log(data.pageData);
+    }
 
-      data.body = await getTemplateResultString(templateResult);
-    } else if (getBody) {
-      const templateResult = await getBody(compilation, page);
+    if (getBody) {
+      const templateResult = await getBody(compilation, page, data.pageData);
 
-      data.body = await getTemplateResultString(templateResult);
+      data.body = await collectResult(render(templateResult));
     }
 
     if (getTemplate) {
       const templateResult = await getTemplate(compilation, page);
 
-      data.template = await getTemplateResultString(templateResult);
+      data.template = await collectResult(render(templateResult));
     }
 
     if (getFrontmatter) {
